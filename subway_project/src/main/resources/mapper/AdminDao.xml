<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- LoginVerification_Dao의 위치를 알려주기 위해 namespace를 씀 -->
<mapper namespace="com.springlec.base.dao.admin.AdminDao">
	
	<!-- adminLogin을 위한 query -->
	<select id="loginVerification" resultType="com.springlec.base.model.admin.LoginVerification_Dto">
		SELECT mid, mpw
		FROM member
		WHERE mid = #{mid}
	</select>
	
	<!--************************ ProductInsertDB TASK query *********************-->
	<insert id="insertMenuAction">
		INSERT INTO menu (mnctg, mnname, mnengname, mninfo, mnimg, mnprice)
		VALUES (#{mnctg}, #{mnname}, #{mnengname}, #{mninfo}, #{mnimg}, #{mnprice})
	</insert>
	<insert id="insertMenuSpecAction">
		INSERT INTO menuspec (mncode, mngram, mnkcal, mnprotein, mnfat, mnsugar, mnnatrum)
		VALUES
		((SELECT mncode FROM menu ORDER BY mncode DESC LIMIT 1), 
				#{mngram}, #{mnkcal}, #{mnprotein}, #{mnfat}, #{mnsugar}, #{mnnatrum})
	</insert>
	<!--********************* ProductInsertDB Task query End ******************-->
	
	<!-- ProductListSelect Task query  -->
	<select id="productListSelect" resultType="com.springlec.base.model.admin.ProductCrudDto">
		SELECT m.mncode, m.mnctg, m.mnname, m.mnengname, m.mninfo, m.mnimg, m.mnprice, 
		    s.mngram, s.mnkcal, s.mnprotein, s.mnfat, s.mnsugar, s.mnnatrum
		FROM menu AS m, menuspec AS s
		WHERE m.mncode = s.mncode
	</select>

	<!-- ProductListSearch Task query  -->
	<select id="productListSearch" resultType="com.springlec.base.model.admin.ProductCrudDto">
		SELECT mncode, mnctg, mnname, mnengname, mninfo, mnimg, mnprice FROM menu
		WHERE ${selectSearch} LIKE #{search} OR mnengname LIKE #{search}
	</select>
	
	<select id="productDetail">
	SELECT m.mncode, m.mnctg, m.mnname, m.mnengname, m.mninfo, m.mnimg, m.mnprice,
			s.mngram, s.mnkcal, s.mnprotein, s.mnfat, s.mnsugar, s.mnnatrum
	FROM menu AS m, menuspec AS s
	WHERE m.mncode = #{mncode} AND m.mncode = s.mncode
	</select>
	
</mapper>